---
focus: src/main/java/SimpleLdapService.java
---

### LDAP Injection Prevention
___

**1) Login injection**

The service method ***authenticateClient*** uses [filter](src/main/java/SimpleLdapService.java:35) to check login/password pair from our LDAP server:

`String filter = "(&(uid=" + user + ")(userPassword=" + password + "))";`

By using the following values:

`user = "\*)(uid=\*))(|(uid=\*"`

`password = "doesn't matter"`

the search filter will result in:

`String filter = "(&(uid=\*)(uid=\*))(|(uid=\*)(userPassword=doesn't matter))";`

which is correct and always true.


**2) Search injection**

The service method ***searchByUid*** uses [search filter](src/main/java/SimpleLdapService.java:53) to find user from our LDAP server:
`"uid=" + uid`

If the value `uid` is replaced with a `*`, by sending the request:
`http://www.example.com/ldapsearch?user=*`

the filter will look like:

`filter="(uid=*)"`

as a result we've got all users (in example from *"ou=people"*) instead of empty list.